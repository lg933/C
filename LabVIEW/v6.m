Corners= [
162, 483;
464, 148;
22, 36;
197, 6;
];

C0= [
87, 186;
84, 181;
89, 177;
72, 175;
84, 173;
95, 168;
74, 164;
85, 164;
65, 160;
68, 154;
93, 152;
60, 148;
80, 147;
75, 145;
68, 143;
91, 143;
62, 142;
90, 142;
175, 139;
189, 137;
174, 136;
185, 136;
76, 134;
92, 133;
78, 131;
81, 130;
80, 129;
159, 129;
172, 129;
75, 127;
161, 127;
59, 126;
168, 126;
178, 126;
162, 125;
172, 125;
50, 123;
88, 122;
89, 120;
151, 116;
90, 115;
145, 115;
160, 115;
80, 113;
169, 113;
174, 112;
145, 111;
178, 111;
162, 110;
134, 108;
141, 108;
147, 108;
250, 107;
155, 106;
75, 105;
78, 105;
164, 105;
82, 104;
134, 104;
241, 104;
172, 103;
243, 103;
87, 102;
168, 102;
236, 102;
130, 101;
153, 101;
162, 101;
241, 101;
229, 100;
121, 98;
235, 98;
123, 97;
140, 97;
130, 96;
161, 96;
81, 95;
117, 95;
246, 95;
166, 94;
78, 93;
169, 93;
120, 92;
163, 92;
166, 92;
154, 90;
210, 90;
216, 90;
232, 90;
242, 90;
229, 89;
234, 88;
216, 86;
232, 86;
109, 85;
120, 85;
162, 85;
211, 85;
225, 85;
227, 85;
90, 84;
115, 84;
212, 84;
295, 84;
300, 84;
81, 83;
84, 83;
206, 83;
214, 83;
290, 83;
79, 82;
85, 82;
156, 82;
291, 82;
91, 81;
293, 81;
92, 80;
200, 80;
230, 80;
296, 80;
74, 79;
98, 79;
195, 79;
211, 79;
217, 79;
79, 78;
101, 78;
103, 78;
188, 77;
228, 77;
229, 77;
294, 77;
79, 76;
222, 76;
74, 75;
156, 75;
294, 75;
94, 74;
273, 74;
288, 74;
293, 74;
93, 73;
188, 73;
227, 73;
279, 73;
284, 73;
289, 73;
104, 72;
186, 72;
188, 72;
80, 71;
183, 71;
217, 71;
219, 71;
274, 71;
189, 70;
263, 70;
80, 69;
81, 69;
176, 69;
177, 69;
275, 69;
98, 68;
148, 68;
174, 68;
257, 68;
258, 68;
279, 68;
85, 67;
148, 67;
276, 67;
279, 67;
75, 66;
86, 66;
169, 66;
157, 65;
217, 65;
250, 65;
268, 65;
80, 64;
91, 64;
92, 64;
213, 64;
82, 63;
216, 63;
246, 63;
251, 63;
258, 63;
142, 62;
156, 62;
216, 62;
255, 62;
146, 61;
149, 61;
163, 61;
171, 61;
217, 61;
275, 61;
237, 60;
254, 60;
270, 60;
272, 60;
149, 59;
155, 59;
162, 59;
205, 59;
82, 58;
271, 58;
246, 57;
267, 57;
140, 56;
155, 56;
243, 56;
228, 55;
162, 54;
264, 54;
267, 54;
138, 53;
147, 53;
152, 53;
201, 53;
205, 53;
206, 52;
138, 51;
142, 51;
231, 51;
260, 51;
139, 50;
150, 50;
155, 50;
262, 50;
263, 50;
144, 49;
205, 49;
145, 48;
224, 48;
261, 48;
139, 47;
194, 47;
195, 47;
206, 47;
198, 46;
204, 46;
213, 46;
218, 46;
250, 46;
218, 45;
251, 45;
195, 44;
199, 44;
207, 44;
250, 44;
207, 43;
194, 42;
199, 42;
208, 42;
211, 42;
255, 42;
198, 40;
208, 40;
249, 40;
201, 39;
203, 39;
244, 39;
190, 37;
245, 37;
250, 37;
186, 36;
193, 36;
194, 36;
195, 36;
237, 36;
189, 35;
191, 35;
246, 34;
236, 32;
238, 32;
232, 31;
235, 28;
232, 27;
228, 26;
230, 26;
232, 26;
];

C1= [
160, 418;
161, 380;
158, 367;
167, 367;
133, 349;
122, 347;
144, 342;
133, 334;
143, 315;
193, 314;
128, 313;
140, 313;
157, 313;
146, 309;
144, 294;
161, 292;
202, 292;
108, 289;
166, 287;
150, 281;
167, 279;
168, 278;
134, 276;
177, 273;
179, 273;
116, 272;
104, 271;
136, 268;
142, 268;
98, 267;
197, 267;
166, 266;
139, 265;
177, 258;
185, 258;
153, 255;
201, 254;
147, 253;
176, 253;
144, 250;
184, 250;
136, 246;
193, 243;
212, 240;
135, 239;
199, 238;
148, 234;
154, 234;
179, 233;
196, 230;
177, 228;
191, 228;
155, 224;
203, 220;
174, 219;
207, 217;
148, 208;
167, 204;
155, 202;
188, 199;
185, 198;
210, 198;
169, 197;
167, 196;
198, 196;
198, 192;
199, 188;
188, 185;
167, 183;
169, 183;
196, 181;
222, 180;
184, 175;
207, 174;
210, 169;
161, 167;
203, 167;
226, 167;
159, 166;
168, 166;
224, 166;
172, 165;
197, 165;
191, 164;
167, 163;
218, 163;
213, 162;
193, 161;
204, 160;
184, 159;
197, 159;
199, 159;
223, 159;
174, 158;
188, 158;
226, 157;
229, 155;
180, 152;
226, 152;
204, 151;
230, 151;
170, 150;
176, 150;
198, 150;
210, 148;
227, 147;
217, 145;
197, 141;
235, 141;
191, 139;
223, 135;
206, 134;
185, 133;
178, 132;
215, 132;
229, 132;
233, 127;
219, 126;
226, 126;
236, 126;
211, 125;
185, 124;
206, 121;
189, 119;
221, 119;
187, 118;
208, 118;
234, 118;
184, 117;
200, 117;
212, 117;
192, 114;
193, 114;
233, 114;
244, 112;
200, 111;
201, 110;
214, 110;
220, 108;
228, 108;
250, 108;
251, 107;
203, 105;
204, 105;
217, 105;
242, 105;
243, 105;
220, 104;
213, 103;
255, 103;
248, 102;
206, 100;
231, 100;
200, 99;
207, 99;
242, 99;
248, 99;
263, 98;
221, 97;
229, 96;
235, 95;
247, 94;
268, 94;
214, 93;
227, 93;
269, 93;
196, 92;
203, 91;
272, 91;
204, 90;
206, 89;
211, 89;
226, 89;
273, 89;
350, 89;
230, 88;
254, 88;
291, 88;
316, 88;
327, 88;
336, 88;
344, 88;
213, 87;
265, 87;
275, 87;
313, 87;
322, 87;
329, 87;
336, 87;
214, 86;
220, 86;
240, 86;
276, 86;
294, 86;
309, 86;
214, 85;
314, 85;
334, 85;
202, 84;
203, 84;
207, 84;
256, 84;
267, 84;
278, 84;
288, 84;
309, 84;
319, 84;
324, 84;
311, 83;
338, 83;
340, 83;
249, 82;
251, 82;
279, 82;
298, 82;
327, 82;
204, 81;
232, 81;
312, 81;
228, 80;
238, 80;
243, 79;
295, 79;
296, 79;
329, 79;
223, 78;
254, 78;
278, 78;
296, 78;
307, 78;
230, 77;
252, 77;
256, 77;
313, 77;
235, 76;
247, 76;
263, 76;
266, 76;
239, 75;
259, 75;
295, 75;
298, 75;
224, 74;
256, 74;
266, 74;
274, 74;
298, 74;
304, 74;
224, 73;
260, 73;
315, 73;
216, 72;
229, 72;
262, 72;
278, 72;
225, 71;
244, 71;
264, 71;
312, 71;
222, 70;
253, 70;
242, 69;
270, 69;
299, 69;
300, 69;
306, 69;
227, 68;
276, 68;
310, 67;
267, 66;
267, 65;
239, 64;
241, 64;
248, 64;
267, 64;
295, 64;
257, 63;
259, 63;
287, 63;
256, 62;
];

C2= [
94, 189;
85, 185;
87, 176;
95, 175;
96, 175;
97, 174;
98, 172;
76, 167;
98, 161;
79, 158;
82, 154;
84, 152;
89, 145;
64, 143;
58, 142;
68, 142;
89, 139;
200, 139;
183, 135;
195, 135;
57, 134;
75, 134;
197, 134;
83, 133;
67, 131;
89, 130;
60, 127;
92, 127;
177, 125;
56, 123;
50, 122;
54, 122;
83, 122;
182, 122;
162, 121;
165, 120;
92, 119;
82, 117;
166, 116;
179, 115;
187, 115;
84, 113;
94, 113;
182, 113;
170, 112;
189, 112;
150, 111;
164, 111;
189, 110;
158, 109;
153, 108;
167, 108;
80, 106;
84, 106;
163, 106;
172, 105;
183, 105;
163, 102;
259, 102;
252, 101;
147, 100;
267, 100;
83, 99;
262, 99;
148, 98;
90, 97;
166, 97;
256, 97;
86, 96;
141, 96;
256, 96;
263, 96;
83, 95;
136, 95;
81, 93;
165, 93;
167, 93;
90, 92;
235, 92;
243, 92;
255, 92;
173, 90;
84, 89;
164, 89;
165, 89;
244, 89;
256, 89;
89, 88;
124, 88;
134, 88;
169, 88;
174, 87;
89, 86;
253, 86;
233, 85;
245, 85;
84, 84;
124, 84;
125, 84;
233, 84;
80, 81;
87, 81;
124, 81;
239, 81;
243, 81;
250, 81;
120, 80;
310, 80;
124, 79;
230, 79;
309, 79;
313, 79;
321, 79;
109, 78;
114, 78;
212, 78;
232, 78;
245, 78;
312, 78;
85, 77;
166, 77;
225, 77;
110, 76;
113, 76;
301, 76;
307, 76;
313, 76;
104, 75;
316, 75;
91, 73;
160, 73;
216, 73;
233, 73;
240, 73;
294, 73;
303, 73;
161, 72;
166, 72;
208, 72;
85, 71;
102, 71;
107, 71;
155, 71;
207, 71;
88, 70;
165, 70;
203, 70;
205, 70;
240, 70;
301, 70;
111, 69;
198, 69;
285, 69;
97, 68;
103, 68;
154, 68;
87, 67;
302, 67;
226, 66;
232, 66;
233, 66;
288, 66;
156, 65;
194, 65;
227, 65;
276, 65;
186, 64;
224, 64;
272, 64;
78, 63;
80, 63;
193, 63;
228, 63;
279, 63;
97, 62;
104, 62;
276, 62;
286, 62;
300, 62;
157, 61;
193, 61;
228, 61;
285, 61;
296, 61;
90, 59;
151, 59;
184, 59;
228, 59;
276, 59;
155, 58;
281, 58;
292, 58;
88, 57;
179, 57;
181, 57;
283, 57;
284, 57;
147, 56;
159, 56;
174, 56;
225, 56;
279, 56;
151, 55;
177, 55;
180, 55;
260, 55;
264, 55;
76, 54;
81, 54;
161, 54;
168, 54;
169, 54;
172, 54;
256, 54;
84, 53;
146, 53;
251, 53;
256, 53;
280, 53;
248, 52;
255, 52;
155, 51;
162, 51;
214, 51;
276, 51;
79, 50;
149, 50;
169, 50;
248, 50;
274, 50;
151, 48;
241, 48;
242, 48;
147, 47;
157, 47;
207, 47;
237, 47;
272, 47;
143, 46;
233, 46;
239, 46;
157, 45;
161, 45;
267, 45;
228, 44;
149, 43;
213, 43;
224, 43;
140, 42;
149, 42;
203, 42;
210, 42;
152, 41;
154, 41;
210, 41;
202, 40;
210, 40;
223, 40;
143, 39;
147, 39;
219, 39;
215, 37;
197, 36;
206, 36;
217, 36;
205, 35;
218, 35;
195, 34;
194, 33;
207, 33;
196, 32;
212, 32;
197, 31;
201, 31;
199, 30;
198, 29;
199, 28;
192, 26;
];

C3= [
63, 159;
65, 155;
88, 149;
90, 146;
60, 145;
63, 144;
56, 141;
83, 141;
67, 139;
104, 139;
68, 137;
97, 137;
63, 136;
105, 134;
63, 133;
70, 133;
113, 133;
69, 132;
72, 131;
70, 130;
92, 130;
128, 130;
88, 129;
109, 129;
72, 126;
110, 126;
74, 125;
117, 125;
93, 123;
82, 122;
132, 122;
56, 121;
87, 121;
138, 121;
144, 121;
76, 118;
137, 118;
81, 117;
116, 117;
91, 116;
97, 116;
71, 115;
130, 115;
144, 112;
95, 111;
105, 111;
129, 111;
159, 111;
75, 110;
152, 110;
106, 109;
107, 109;
114, 109;
133, 109;
102, 108;
121, 108;
136, 108;
154, 108;
162, 108;
83, 107;
139, 107;
143, 107;
57, 106;
95, 106;
101, 105;
64, 104;
87, 104;
77, 103;
116, 102;
143, 102;
155, 102;
157, 102;
167, 102;
176, 101;
178, 101;
180, 101;
86, 100;
105, 100;
161, 100;
103, 99;
110, 99;
131, 99;
156, 99;
171, 99;
173, 99;
89, 97;
148, 96;
174, 96;
183, 96;
108, 95;
164, 95;
112, 94;
144, 94;
187, 93;
189, 93;
136, 92;
139, 92;
102, 91;
131, 91;
164, 91;
188, 91;
191, 91;
128, 90;
139, 90;
174, 90;
175, 90;
189, 90;
195, 90;
199, 90;
120, 89;
190, 89;
191, 89;
111, 88;
156, 88;
118, 87;
128, 86;
150, 85;
155, 85;
183, 85;
199, 85;
210, 85;
174, 83;
177, 83;
208, 83;
142, 81;
174, 81;
148, 80;
183, 80;
184, 80;
190, 80;
197, 80;
207, 80;
143, 79;
185, 79;
189, 79;
190, 79;
134, 78;
142, 77;
204, 77;
138, 76;
188, 76;
211, 76;
223, 76;
218, 75;
151, 73;
192, 73;
204, 73;
235, 73;
153, 72;
160, 72;
180, 72;
209, 72;
191, 71;
208, 71;
247, 71;
157, 70;
238, 70;
217, 69;
225, 69;
240, 69;
243, 69;
183, 68;
202, 68;
222, 68;
230, 68;
158, 67;
194, 67;
212, 67;
242, 67;
245, 67;
197, 66;
221, 66;
243, 66;
245, 66;
170, 65;
178, 65;
184, 65;
251, 65;
263, 65;
275, 65;
177, 64;
192, 64;
211, 64;
232, 64;
242, 64;
252, 64;
274, 64;
179, 63;
229, 63;
242, 63;
255, 63;
268, 63;
282, 63;
288, 63;
227, 62;
266, 62;
176, 61;
192, 61;
201, 61;
202, 61;
211, 61;
215, 61;
268, 61;
272, 61;
283, 61;
295, 61;
180, 60;
216, 60;
239, 60;
266, 60;
292, 60;
218, 59;
222, 59;
227, 59;
240, 59;
256, 59;
181, 58;
190, 58;
202, 58;
251, 58;
253, 58;
268, 58;
272, 58;
291, 58;
202, 57;
210, 57;
218, 57;
235, 57;
247, 57;
251, 57;
276, 57;
203, 56;
268, 56;
273, 56;
220, 55;
192, 54;
213, 54;
235, 54;
240, 54;
241, 54;
270, 54;
284, 54;
208, 53;
229, 53;
257, 53;
260, 53;
261, 53;
207, 52;
218, 52;
221, 52;
277, 52;
224, 51;
263, 51;
236, 50;
247, 50;
269, 50;
227, 49;
239, 49;
242, 49;
252, 49;
267, 49;
268, 49;
271, 48;
239, 47;
240, 47;
255, 47;
240, 46;
258, 46;
264, 46;
270, 46;
257, 45;
261, 45;
248, 44;
257, 44;
262, 44;
258, 43;
];

C4= [
131, 328;
187, 307;
190, 303;
111, 299;
134, 297;
137, 288;
149, 285;
221, 282;
213, 280;
100, 279;
222, 277;
161, 272;
147, 271;
201, 270;
178, 268;
120, 267;
150, 267;
124, 266;
183, 266;
191, 262;
103, 261;
226, 259;
104, 258;
122, 256;
157, 256;
212, 256;
107, 255;
138, 255;
125, 254;
219, 253;
146, 249;
211, 245;
109, 244;
196, 240;
235, 240;
173, 239;
134, 237;
238, 236;
153, 235;
226, 234;
101, 232;
176, 232;
87, 231;
219, 231;
232, 231;
90, 230;
121, 229;
138, 229;
182, 226;
115, 225;
117, 224;
99, 223;
132, 223;
164, 220;
222, 220;
154, 219;
242, 218;
164, 217;
117, 216;
146, 215;
232, 213;
249, 212;
136, 210;
132, 209;
165, 208;
144, 207;
178, 206;
151, 204;
193, 204;
198, 204;
186, 202;
251, 202;
192, 200;
251, 200;
144, 198;
192, 198;
166, 197;
224, 197;
230, 197;
219, 194;
193, 191;
238, 189;
172, 188;
178, 184;
198, 181;
235, 179;
197, 177;
179, 172;
231, 172;
211, 170;
196, 169;
180, 167;
242, 167;
193, 166;
233, 166;
251, 166;
227, 163;
244, 163;
186, 162;
187, 161;
222, 161;
252, 159;
202, 157;
228, 155;
238, 155;
242, 155;
191, 154;
222, 154;
229, 154;
192, 153;
243, 153;
247, 153;
193, 151;
252, 151;
206, 148;
197, 147;
198, 146;
242, 146;
250, 146;
194, 145;
228, 144;
195, 142;
208, 141;
211, 140;
253, 140;
243, 139;
202, 137;
225, 136;
243, 135;
227, 129;
245, 129;
253, 128;
226, 127;
204, 126;
216, 125;
240, 125;
252, 124;
240, 120;
237, 119;
213, 118;
225, 118;
249, 117;
214, 114;
234, 113;
247, 113;
213, 110;
219, 110;
251, 109;
235, 107;
239, 107;
242, 107;
218, 106;
232, 106;
244, 106;
220, 105;
240, 103;
224, 102;
231, 101;
241, 98;
247, 98;
212, 96;
218, 96;
234, 93;
222, 90;
223, 88;
247, 88;
229, 87;
232, 85;
218, 83;
210, 82;
226, 82;
232, 82;
234, 82;
246, 82;
240, 81;
240, 80;
217, 78;
227, 78;
212, 77;
241, 77;
229, 76;
230, 76;
237, 76;
242, 76;
245, 76;
218, 74;
219, 74;
248, 74;
222, 72;
250, 71;
246, 69;
235, 68;
214, 67;
227, 66;
221, 65;
224, 65;
245, 65;
225, 64;
251, 64;
212, 63;
217, 63;
232, 63;
234, 63;
215, 62;
230, 61;
246, 61;
253, 61;
224, 60;
257, 57;
240, 56;
250, 56;
271, 56;
277, 56;
214, 55;
224, 55;
239, 55;
217, 54;
232, 54;
249, 54;
250, 54;
253, 54;
278, 54;
279, 54;
281, 54;
216, 53;
225, 53;
226, 53;
252, 53;
263, 53;
267, 53;
242, 52;
245, 52;
274, 52;
278, 52;
251, 51;
218, 50;
224, 50;
255, 50;
261, 50;
276, 50;
218, 49;
221, 49;
229, 49;
246, 49;
251, 49;
248, 48;
274, 48;
221, 47;
222, 47;
258, 47;
260, 47;
242, 45;
250, 45;
256, 45;
226, 44;
227, 44;
240, 44;
255, 44;
225, 43;
232, 43;
244, 42;
262, 42;
238, 41;
240, 40;
247, 39;
252, 39;
255, 39;
256, 39;
234, 38;
246, 38;
];

T ={C0 C1 C2 C3 C4 };

MarkerShape = 'o';
MarkerSize = 7;
Title = 'v6.png';
Colors = [0,0,255
;51,255,0
;153,102,51
;255,0,255
;255,102,0

];
[Width, Height, A, B, C, D] = orderCorners(Corners);
M = computeM(A, B, C, D, Width, Height);
for i = 1:length(T)
    trace = T{i};
    W = applyM(M, trace);
    [X, Y, ParamStr, Yfit] = FindTrace(W, Width, Height);
    GraphicsDisplay(X, Y, ParamStr, Yfit, Title, MarkerSize, MarkerShape, Colors, i)
end
exportgraphics(gcf, '/Users/leogallacio/Downloads/LabVIEW/v6.pdf', 'ContentType', 'vector');
open('/Users/leogallacio/Downloads/LabVIEW/v6.pdf');
uiwait(gcf);